<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thông Tin Tài Khoản - MASH</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- HEADER -->
  <header class="flex justify-between items-center px-8 py-4 bg-white shadow-md">
    <h2 class="text-2xl font-bold text-[#8B0000]">
        <a href="./pages.html" class="hover:text-[#8B0000]">MASH</a>
      </h2>
      <nav class="hidden md:flex space-x-6 text-sm font-medium absolute left-1/2 transform -translate-x-1/2">
        <a href="./pages.html" class="hover:text-[#8B0000]">Trang chủ</a>
        <a href="./sanpham.html" class="hover:text-[#8B0000]">Sản phẩm</a>
        <a href="./gioithieu.html" class="hover:text-[#8B0000]">Giới thiệu</a>
        <a href="./lienhe.html" class="hover:text-[#8B0000]">Liên hệ</a>
      </nav>
  
    <button id="logoutBtn" class="bg-[#8B0000] text-white px-4 py-2 rounded-full hover:bg-red-900 transition">
      Đăng xuất
    </button>
  </header>

  <div class="flex">
    
    <div class="w-1/4 p-6 border-r border-gray-200">
        <h2 class="text-xl font-bold mb-6 text-red-700">Tài khoản của tôi</h2>
        <nav>
            <ul>
                <li class="mb-3">
                    <a href="./thongtinKH.html" class="text-gray-700 hover:text-red-700">Thông tin cá nhân</a>
                </li>
                <li class="mb-3">
                    <a href="#" class="font-bold text-red-700 border-l-4 border-red-700 pl-2">Lịch sử mua hàng</a>
                </li>
            </ul>
        </nav>
    </div>

    <div class="w-3/4 p-8">
        <h1 class="text-2xl font-extrabold mb-8">Lịch sử mua hàng</h1>

        <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên Sản Phẩm</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Số Lượng</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ngày Đặt</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thành Tiền</th>
                    </tr>
                </thead>
                <tbody id="orderTableBody" class="bg-white divide-y divide-gray-200">
                </tbody>
            </table>
        </div>
        </div>
</div>

  <!-- FOOTER -->
  <footer class="bg-white text-center py-4 border-t text-sm text-gray-600">
    © 2025 MASH Bakery. All rights reserved.
  </footer>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
        const tbody = document.getElementById("orderTableBody"); 
        const orderHistory = JSON.parse(localStorage.getItem("orderHistory")) || [];

        if (orderHistory.length === 0) {
       
            tbody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">
                Chưa có đơn hàng nào được đặt.
            </td></tr>`;
            return;
        }
        
        let allItemsHtml = '';

        orderHistory.forEach(order => {
            let isFirstItem = true; 

     
            order.items.forEach(item => {
                const itemTotal = (item.price || 0) * item.quantity;
                
                const itemRow = `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-3 whitespace-nowrap text-sm font-medium text-gray-900">${item.name}</td>
                        
                        <td class="px-6 py-3 whitespace-nowrap text-sm text-gray-500">${item.quantity}</td>
                        
                        ${isFirstItem ? 
                           
                            `<td rowspan="${order.items.length}" class="px-6 py-3 whitespace-nowrap text-sm text-gray-500 border-l border-r border-gray-100 font-semibold align-top pt-4">
                                ${order.date}
                            </td>` 
                            : ''
                        }

                        <td class="px-6 py-3 whitespace-nowrap text-sm text-gray-900">
                            ${itemTotal.toLocaleString("vi-VN")} VNĐ
                        </td>
                    </tr>
                `;
                allItemsHtml += itemRow;
                
                isFirstItem = false; 
            });
            
       
            const totalRow = `
                <tr>
                    <td colspan="3" class="px-6 py-2 text-right font-bold bg-gray-100 text-gray-800">TỔNG ĐƠN :</td>
                    <td class="px-6 py-2 whitespace-nowrap font-bold text-[#8B0000] bg-gray-100">
                        ${order.total.toLocaleString("vi-VN")} VNĐ
                    </td>
                </tr>
            `;
            allItemsHtml += totalRow;
            
            // Thêm dòng trống để phân tách các đơn hàng
            allItemsHtml += `<tr class="h-4"></tr>`;
        });
        
        tbody.innerHTML = allItemsHtml;
        
        
        // Xử lý nút Đăng xuất 
        const logoutBtn = document.getElementById("logoutBtn");
        if (logoutBtn) {
            logoutBtn.addEventListener("click", () => {
                localStorage.removeItem("currentUser");
                window.location.href = "./pages.html"; // Chuyển hướng về trang chủ sau đăng xuất
            });
        }
    });
</script>
</body>
</html>

  